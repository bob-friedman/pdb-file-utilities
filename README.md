# pdb-file-utilities
Python code to help process files of 3d protein structure (PDB format).

This initial set of files are samples of code used to process files for a research project. They are released as examples of access to the biopython and other modules.

## `pairwise-compare-files.py`

**Purpose:** This script iterates through a specified directory and prints all unique pairs of files found within that directory. This is useful for tasks that require comparing each file in a set against every other file.

**Usage:**
1.  **Set the directory:** Before running the script, you must modify the `directory` variable within the script to point to the target directory containing the files you want to process.
    ```python
    directory = "/path/to/your/files"  # Change this to your directory
    ```
2.  **Run the script:** Execute the script from your terminal:
    ```bash
    python pairwise-compare-files.py
    ```

**Output Format & Adaptability:**
The script prints pairs of file paths, one pair per line, separated by a space. This output format is intentionally simple and can be easily adapted for use in shell scripts or other automation workflows. For example, you could redirect the output to a file and then use it to generate commands for running comparative analyses like TMscore:

Example output line:
`/path/to/your/files/file1.pdb /path/to/your/files/file2.pdb`

This could be used in a shell script like so:
```bash
# Assuming the output of pairwise-compare-files.py is saved in pairs.txt
while read file1 file2; do
  echo "Comparing $file1 and $file2"
  TMscore "$file1" "$file2" >> results.txt
done < pairs.txt
```

**Note:** The script currently prints absolute paths to the files. You might need to adjust this behavior depending on your specific use case.

## `pdb-model-chain.py`

**Purpose:** This script prints model and protein chain information from PDB (`.pdb`) files. It iterates through PDB files in the current directory, extracting and displaying details about the models and chains within each file.

**Usage:**
1.  **Navigate to the directory:** Open your terminal and change to the directory containing the `.pdb` files you wish to analyze.
2.  **Run the script:** Execute the script from your terminal:
    ```bash
    python pdb-model-chain.py
    ```
    The script will automatically process all `.pdb` files found in the current working directory.

**Dependencies:**
*   **BioPython:** This script requires the BioPython library to parse PDB files. You can install it using pip:
    ```bash
    pip install biopython
    ```

## `pdb-residue-index-reset.py`

**Purpose:** This script resets the residue numbering in PDB (`.pdb`) files to start from 1 for each chain. This is particularly useful for standardizing PDB files or preparing them for further analysis where consistent residue indexing is required.

**Usage:**
1.  **Set the directory:** Before running the script, you must modify the `directory` variable within the script to point to the target directory containing the `.pdb` files you want to process.
    ```python
    directory = "/path/to/your/pdb_files"  # Change this to your directory
    ```
2.  **Run the script:** Execute the script from your terminal:
    ```bash
    python pdb-residue-index-reset.py
    ```
    The script will process all `.pdb` files in the specified directory and overwrite the original files with the residue numbering reset.

**Dependencies:**
*   **BioPython:** This script requires the BioPython library to parse and manipulate PDB files. You can install it using pip:
    ```bash
    pip install biopython
    ```

**Note:** This script is primarily intended for use with PDB files that have been split into individual chain files, for example, those generated by the `pdb-split-files.py` script. Applying it to multi-chain PDB files might lead to residue numbers being reset for each chain within that single file, which may or may not be the desired outcome.

## `pdb-split-files.py`

**Purpose:** This script splits PDB (`.pdb`) files into multiple smaller PDB files. Each of the generated files contains a subsequence of 9 amino acid residues from the original PDB file.

**Usage:**
1.  **Set the directory:** Before running the script, you must modify the `directory` variable within the script to point to the target directory containing the `.pdb` files you want to process.
    ```python
    directory = "/path/to/your/pdb_files"  # Change this to your directory
    ```
2.  **Run the script:** Execute the script from your terminal:
    ```bash
    python pdb-split-files.py
    ```
    The script will process all `.pdb` files in the specified directory. The output PDB files, each containing a 9-residue subsequence, will be saved in the same directory.

**Dependencies:**
*   **BioPython:** This script requires the BioPython library to parse and manipulate PDB files. You can install it using pip:
    ```bash
    pip install biopython
    ```

**Warning:** This script can generate a large number of output files, especially when processing PDB files with many residues or a large number of PDB files in the input directory. It is strongly recommended to test this script on a small subset of your data first to understand the potential output volume.

## `download_pdb.py`

**Purpose:** This script downloads PDB structure files from the RCSB PDB website (rcsb.org) using their unique 4-character PDB IDs.

**Usage:**
The script requires PDB IDs to be provided via one of two methods: a direct comma-separated list or a text file. An output directory can also be specified.

**Command-line Arguments:**

*   `--pdb_ids "ID1,ID2,..."`: (Required, unless --id_file is used) A comma-separated string of PDB IDs to download (e.g., `"1EHZ,2ABC,1XYZ"`).
*   `--id_file /path/to/your/ids.txt`: (Required, unless --pdb_ids is used) Path to a text file where each line contains one PDB ID.
*   `--output_dir /path/to/your/download_folder`: (Optional) Specifies the directory where PDB files will be saved. If not provided, files will be saved to a directory named `pdb_downloads` in the current working directory.

**Note:** You must provide PDB IDs using either the `--pdb_ids` argument or the `--id_file` argument. If both are provided, the script will produce an error.

**Examples:**

1.  Download specific PDB IDs to the default directory (`./pdb_downloads`):
    ```bash
    python download_pdb.py --pdb_ids "1EHZ,2ABC"
    ```

2.  Download PDB IDs from a file to a custom directory:
    ```bash
    python download_pdb.py --id_file "my_pdb_ids.txt" --output_dir "protein_structures"
    ```
    *(Content of `my_pdb_ids.txt`):*
    ```text
    1EHZ
    1XYZ
    2ABC
    ```

3.  Download specific PDB IDs to a custom directory:
    ```bash
    python download_pdb.py --pdb_ids "4HHB,1A00" --output_dir "/data/pdb_files"
    ```

**Dependencies:**
*   **requests:** This script uses the `requests` library to fetch files from the internet. Install it using pip:
    ```bash
    pip install requests
    ```

**Error Handling:**
The script includes error handling for common issues such as:
*   Invalid or non-existent PDB IDs (resulting in 404 errors from RCSB).
*   Network connectivity problems (e.g., connection timeouts).
*   File system errors (e.g., issues creating the output directory or writing files).
It will print informative messages for such errors (to standard error) and continue to process other PDB IDs if possible. A summary of successful and failed downloads is provided at the end. The script will exit with a non-zero status code if any downloads fail or if critical errors occur.
